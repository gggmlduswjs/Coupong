# ì„¤ì • ê°€ì´ë“œ

#guide #configuration #setup

**ì‘ì„±ì¼:** 2026-02-05

---

## ğŸ”§ ì´ˆê¸° ì„¤ì •

### 1. í™˜ê²½ ë³€ìˆ˜ (.env)

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env` íŒŒì¼ ìƒì„±:

```bash
# C:\Users\MSI\Desktop\Coupong\.env

# ì•Œë¼ë”˜ API
ALADIN_TTB_KEY=your_ttb_key_here

# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_URL=sqlite:///coupang.db

# Obsidian
OBSIDIAN_VAULT_PATH=C:\Users\MSI\Desktop\Coupong\obsidian_vault

# ê³„ì • ì„¤ì •
DEFAULT_DAILY_UPLOAD_LIMIT=20
NUM_ACCOUNTS=5
```

### 2. ì•Œë¼ë”˜ API Key ë°œê¸‰

1. **ì•Œë¼ë”˜ íšŒì›ê°€ì…**
   - https://www.aladin.co.kr/ ì ‘ì†
   - íšŒì›ê°€ì… (ë¬´ë£Œ)

2. **API Key ì‹ ì²­**
   - https://www.aladin.co.kr/ttb/wstart.aspx
   - TTBKey ë°œê¸‰ ì‹ ì²­
   - ìŠ¹ì¸ê¹Œì§€ 1-2ì¼ ì†Œìš”

3. **.envì— Key ì¶”ê°€**
   ```
   ALADIN_TTB_KEY=ttbì—¬ê¸°ì—ë°œê¸‰ë°›ì€í‚¤ì…ë ¥
   ```

### 3. Python íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
pip install -r requirements.txt
```

í•„ìˆ˜ íŒ¨í‚¤ì§€:
```
SQLAlchemy==2.0.23
pydantic==2.5.0
pydantic-settings==2.1.0
requests==2.31.0
python-dotenv==1.0.0
```

---

## ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡° ì„¤ì •

### ìë™ ìƒì„± (ê¶Œì¥)

```python
# setup_directories.py

from pathlib import Path

# í•„ìš”í•œ ë””ë ‰í† ë¦¬ ìƒì„±
directories = [
    "output",
    "logs",
    "backups",
    "data/raw",
    "data/processed",
]

for dir_path in directories:
    Path(dir_path).mkdir(parents=True, exist_ok=True)
    print(f"[OK] {dir_path}")
```

ì‹¤í–‰:
```bash
python setup_directories.py
```

### ìˆ˜ë™ ìƒì„±

```
C:\Users\MSI\Desktop\Coupong\
â”œâ”€â”€ output/          (CSV ì¶œë ¥ íŒŒì¼)
â”œâ”€â”€ logs/            (ë¡œê·¸ íŒŒì¼)
â”œâ”€â”€ backups/         (DB ë°±ì—…)
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/         (ì›ë³¸ ë°ì´í„°)
â”‚   â””â”€â”€ processed/   (ê°€ê³µ ë°ì´í„°)
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

### ì´ˆê¸°í™”

```bash
python scripts/init_db_v2_clean.py
```

ì¶œë ¥:
```
[OK] ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
[OK] í…Œì´ë¸” ìƒì„± (8ê°œ)
[OK] ì¶œíŒì‚¬ ë°ì´í„° ë“±ë¡ (24ê°œ)
[OK] í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„± (5ê°œ)
```

### ì»¤ìŠ¤í…€ ì´ˆê¸°í™”

```python
# custom_init.py

from app.database import engine, get_db
from app.models import Base, Publisher, Account

# í…Œì´ë¸” ìƒì„±
Base.metadata.create_all(bind=engine)

db = next(get_db())

# ì¶œíŒì‚¬ ì¶”ê°€
publishers = [
    Publisher(name="EBS", margin_rate=73, supply_rate=0.27, min_free_shipping=50800),
    Publisher(name="ê°œë…ì›ë¦¬", margin_rate=65, supply_rate=0.35, min_free_shipping=23900),
    # ... ë” ì¶”ê°€
]

for pub in publishers:
    db.add(pub)

# ê³„ì • ì¶”ê°€
for i in range(1, 6):
    account = Account(
        account_name=f"account_{i}",
        coupang_id=f"coupang_account_{i}",
        encrypted_password="encrypted",
        daily_upload_limit=20
    )
    db.add(account)

db.commit()
```

---

## ğŸ¢ ì¶œíŒì‚¬ ì„¤ì •

### ì¶œíŒì‚¬ ë°ì´í„° êµ¬ì¡°

```python
# config/publishers.py

PUBLISHERS = {
    "EBS": {
        "margin_rate": 73,      # ë§¤ì…ìœ¨ (%)
        "supply_rate": 0.27,    # ê³µê¸‰ë¥ 
        "min_free_shipping": 50800,  # ë¬´ë£Œë°°ì†¡ ê¸°ì¤€ (ì›)
    },
    "í•œêµ­êµìœ¡ë°©ì†¡ê³µì‚¬": {
        "margin_rate": 73,
        "supply_rate": 0.27,
        "min_free_shipping": 50800,
    },
    "ê°œë…ì›ë¦¬": {
        "margin_rate": 65,
        "supply_rate": 0.35,
        "min_free_shipping": 23900,
    },
    # ... 24ê°œ ì¶œíŒì‚¬
}
```

### ì¶œíŒì‚¬ ì¶”ê°€

```python
# add_publisher.py

from app.database import get_db
from app.models import Publisher

db = next(get_db())

# ìƒˆ ì¶œíŒì‚¬ ì¶”ê°€
new_publisher = Publisher(
    name="ìƒˆì¶œíŒì‚¬",
    margin_rate=60,
    supply_rate=0.40,
    min_free_shipping=18000,
    notes="IT ë„ì„œ ì „ë¬¸ ì¶œíŒì‚¬"
)

db.add(new_publisher)
db.commit()

print(f"ì¶œíŒì‚¬ ì¶”ê°€: {new_publisher.name}")
```

### ì¶œíŒì‚¬ ìˆ˜ì •

```python
# update_publisher.py

from app.database import get_db
from app.models import Publisher

db = next(get_db())

# ì¶œíŒì‚¬ ì¡°íšŒ
publisher = db.query(Publisher).filter(
    Publisher.name == "ê°œë…ì›ë¦¬"
).first()

# ë§ˆì§„ìœ¨ ìˆ˜ì •
publisher.margin_rate = 66  # 65% â†’ 66%
publisher.supply_rate = 0.34  # 0.35 â†’ 0.34

db.commit()
print(f"ì¶œíŒì‚¬ ìˆ˜ì •: {publisher.name}")
```

---

## ğŸ‘¤ ê³„ì • ì„¤ì •

### ê³„ì • ì¶”ê°€

```python
# add_account.py

from app.database import get_db
from app.models import Account

db = next(get_db())

# ìƒˆ ê³„ì • ì¶”ê°€
new_account = Account(
    account_name="account_6",
    coupang_id="your_coupang_id",
    encrypted_password="encrypted_password",
    daily_upload_limit=30,  # ì¼ì¼ ì—…ë¡œë“œ í•œë„
    is_active=True
)

db.add(new_account)
db.commit()

print(f"ê³„ì • ì¶”ê°€: {new_account.account_name}")
```

### ê³„ì • í™œì„±í™”/ë¹„í™œì„±í™”

```python
# toggle_account.py

from app.database import get_db
from app.models import Account

db = next(get_db())

# ê³„ì • ì¡°íšŒ
account = db.query(Account).filter(
    Account.account_name == "account_3"
).first()

# ë¹„í™œì„±í™”
account.is_active = False
db.commit()

print(f"ê³„ì • ë¹„í™œì„±í™”: {account.account_name}")
```

### ì¼ì¼ í•œë„ ì¡°ì •

```python
# adjust_limit.py

from app.database import get_db
from app.models import Account

db = next(get_db())

# ëª¨ë“  ê³„ì •ì˜ ì¼ì¼ í•œë„ë¥¼ 30ìœ¼ë¡œ ë³€ê²½
accounts = db.query(Account).all()

for account in accounts:
    account.daily_upload_limit = 30
    print(f"{account.account_name}: {account.daily_upload_limit}")

db.commit()
```

---

## ğŸ¯ ë§ˆì§„ ê³„ì‚° ì„¤ì •

### ê¸°ë³¸ ì„¤ì •

```python
# app/config.py

class Settings(BaseSettings):
    # ë„ì„œì •ê°€ì œ
    BOOK_DISCOUNT_RATE: float = 0.9  # ìµœëŒ€ í• ì¸ìœ¨ 10%

    # ì¿ íŒ¡ ìˆ˜ìˆ˜ë£Œ
    COUPANG_FEE_RATE: float = 0.11  # 11%

    # ë°°ì†¡ë¹„
    DEFAULT_SHIPPING_COST: int = 2000  # 2000ì›

    # ë§ˆì§„ ê¸°ì¤€
    MIN_MARGIN_FOR_FREE_SHIPPING: int = 2000  # ë¬´ë£Œë°°ì†¡ ìµœì†Œ ìˆœë§ˆì§„
    MIN_MARGIN_FOR_PAID_SHIPPING: int = 0     # ìœ ë£Œë°°ì†¡ ìµœì†Œ ìˆœë§ˆì§„
```

### ì»¤ìŠ¤í…€ ë§ˆì§„ ê³„ì‚°

```python
# custom_margin.py

class CustomMarginCalculator:
    def __init__(self, shipping_cost=2500):  # ë°°ì†¡ë¹„ 2500ì›
        self.shipping_cost = shipping_cost

    def calculate(self, list_price, supply_rate):
        sale_price = int(list_price * 0.9)
        supply_cost = int(list_price * supply_rate)
        coupang_fee = int(sale_price * 0.11)
        margin = sale_price - supply_cost - coupang_fee
        net_margin = margin - self.shipping_cost

        return {
            'sale_price': sale_price,
            'margin': margin,
            'net_margin': net_margin
        }
```

---

## ğŸ“¦ ë¬¶ìŒ ì„¤ì •

### ë¬¶ìŒ ìƒì„± ì¡°ê±´

```python
# app/config.py

class BundleSettings(BaseSettings):
    MIN_BOOKS_PER_BUNDLE: int = 2    # ìµœì†Œ ê¶Œìˆ˜
    MAX_BOOKS_PER_BUNDLE: int = 10   # ìµœëŒ€ ê¶Œìˆ˜
    MIN_BUNDLE_MARGIN: int = 2000    # ìµœì†Œ ìˆœë§ˆì§„

    # ë¬¶ìŒ ì œì™¸ ì¶œíŒì‚¬
    EXCLUDE_PUBLISHERS: list = [
        "ë§ˆë¦°ë¶ìŠ¤",  # ë§ˆì§„ìœ¨ì´ ë„ˆë¬´ ë‚®ìŒ
        "ì•„ì¹´ë°ë¯¸ì†Œí”„íŠ¸"
    ]
```

### ë¬¶ìŒ ì „ëµ ì»¤ìŠ¤í„°ë§ˆì´ì§•

```python
# custom_bundle_strategy.py

class SmartBundleStrategy:
    def determine_bundle_size(self, books, target_margin=5000):
        """ëª©í‘œ ìˆœë§ˆì§„ì„ ë§ì¶”ê¸° ìœ„í•œ ìµœì  ê¶Œìˆ˜ ê³„ì‚°"""
        sorted_books = sorted(books, key=lambda b: b.list_price, reverse=True)

        for i in range(2, min(len(sorted_books) + 1, 11)):
            bundle_books = sorted_books[:i]
            total_margin = self.calculate_bundle_margin(bundle_books)

            if total_margin >= target_margin:
                return bundle_books

        return sorted_books[:5]  # ê¸°ë³¸ 5ê¶Œ
```

---

## ğŸ“¤ CSV ì¶œë ¥ ì„¤ì •

### CSV í¬ë§· ì„¤ì •

```python
# app/config.py

class CSVSettings(BaseSettings):
    # ì¸ì½”ë”©
    CSV_ENCODING: str = "utf-8-sig"  # Excel í˜¸í™˜

    # êµ¬ë¶„ì
    CSV_DELIMITER: str = ","

    # í—¤ë”
    CSV_HEADERS: list = [
        "ISBN",
        "ì œëª©",
        "íŒë§¤ê°€",
        "ë°°ì†¡ë¹„",
        "ë°°ì†¡ì •ì±…",
        "ì¬ê³ ",
        "ìƒí’ˆì„¤ëª…"
    ]

    # ì¶œë ¥ ê²½ë¡œ
    OUTPUT_DIR: str = "output"
```

### ì»¤ìŠ¤í…€ CSV í¬ë§·

```python
# custom_csv_format.py

class CustomCSVExporter:
    def format_row(self, listing):
        return [
            listing.isbn,
            listing.title,
            f"{listing.sale_price:,}",  # ì²œë‹¨ìœ„ êµ¬ë¶„
            "0" if listing.shipping_policy == 'free' else "2000",
            "ë¬´ë£Œë°°ì†¡" if listing.shipping_policy == 'free' else "ìœ ë£Œë°°ì†¡",
            "999",  # ì¬ê³ 
            self.generate_description(listing)
        ]

    def generate_description(self, listing):
        return f"""
        {listing.title}

        â–  ì •ê°€: {listing.list_price:,}ì›
        â–  íŒë§¤ê°€: {listing.sale_price:,}ì› (10% í• ì¸)
        â–  ì¶œíŒì‚¬: {listing.publisher_name}
        â–  ë°°ì†¡: {listing.shipping_policy}

        [ì •í’ˆ ìƒˆì±… / ë¹ ë¥¸ë°°ì†¡]
        """
```

---

## ğŸ“ ë¡œê¹… ì„¤ì •

### ê¸°ë³¸ ë¡œê¹…

```python
# app/config.py

import logging

# ë¡œê¹… ì„¤ì •
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('logs/app.log'),
        logging.StreamHandler()
    ]
)
```

### Obsidian ë¡œê¹… ì„¤ì •

```python
# app/config.py

class ObsidianSettings(BaseSettings):
    VAULT_PATH: str = "C:\\Users\\MSI\\Desktop\\Coupong\\obsidian_vault"

    # ë””ë ‰í† ë¦¬ êµ¬ì¡°
    DAILY_DIR: str = "01-Daily"
    FEATURES_DIR: str = "02-Features"
    TECHNICAL_DIR: str = "03-Technical"
    DECISIONS_DIR: str = "04-Decisions"
    BUGS_DIR: str = "05-Bugs"

    # ë¡œê¹… í™œì„±í™”
    ENABLE_OBSIDIAN_LOGGING: bool = True
```

---

## ğŸ”„ ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ì • (ì„ íƒì‚¬í•­)

### ì¼ì¼ ìë™ í¬ë¡¤ë§

```python
# scheduler.py

import schedule
import time
from crawlers.aladin_api_crawler import AladinAPICrawler
from scripts.smart_upload_system import SmartUploadSystem

def daily_crawl_job():
    """ë§¤ì¼ ìë™ í¬ë¡¤ë§ ë° ì—…ë¡œë“œ"""
    print("ì¼ì¼ í¬ë¡¤ë§ ì‹œì‘...")

    # ì•Œë¼ë”˜ ê²€ìƒ‰
    crawler = AladinAPICrawler()
    books = crawler.search_books(query="ì‹ ê°„", max_results=100)

    # ì „ì²´ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
    system = SmartUploadSystem()
    system.run_full_workflow()

    print("ì¼ì¼ í¬ë¡¤ë§ ì™„ë£Œ!")

# ë§¤ì¼ ì˜¤ì „ 9ì‹œ ì‹¤í–‰
schedule.every().day.at("09:00").do(daily_crawl_job)

# ìŠ¤ì¼€ì¤„ëŸ¬ ì‹¤í–‰
while True:
    schedule.run_pending()
    time.sleep(60)  # 1ë¶„ë§ˆë‹¤ ì²´í¬
```

ì‹¤í–‰:
```bash
python scheduler.py
```

---

## ğŸš¨ ì•Œë¦¼ ì„¤ì • (ì„ íƒì‚¬í•­)

### ì´ë©”ì¼ ì•Œë¦¼

```python
# notifications/email_notifier.py

import smtplib
from email.mime.text import MIMEText

class EmailNotifier:
    def __init__(self, smtp_server, username, password):
        self.smtp_server = smtp_server
        self.username = username
        self.password = password

    def send(self, to_email, subject, body):
        msg = MIMEText(body)
        msg['Subject'] = subject
        msg['From'] = self.username
        msg['To'] = to_email

        with smtplib.SMTP(self.smtp_server, 587) as server:
            server.starttls()
            server.login(self.username, self.password)
            server.send_message(msg)

# ì‚¬ìš©
notifier = EmailNotifier(
    smtp_server="smtp.gmail.com",
    username="your@email.com",
    password="your_password"
)

notifier.send(
    to_email="your@email.com",
    subject="ì¿ íŒ¡ ì—…ë¡œë“œ ì™„ë£Œ",
    body="ì˜¤ëŠ˜ 20ê°œ ìƒí’ˆ ì—…ë¡œë“œ ì™„ë£Œ!"
)
```

---

## ğŸ”’ ë³´ì•ˆ ì„¤ì •

### ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”

```python
# utils/security.py

from cryptography.fernet import Fernet

class PasswordEncryptor:
    def __init__(self, key=None):
        self.key = key or Fernet.generate_key()
        self.cipher = Fernet(self.key)

    def encrypt(self, password: str) -> str:
        return self.cipher.encrypt(password.encode()).decode()

    def decrypt(self, encrypted: str) -> str:
        return self.cipher.decrypt(encrypted.encode()).decode()

# ì‚¬ìš©
encryptor = PasswordEncryptor()
encrypted_pw = encryptor.encrypt("my_password")
print(f"ì•”í˜¸í™”: {encrypted_pw}")
```

### API Key ë³´í˜¸

```python
# .env íŒŒì¼ì—ë§Œ ì €ì¥ (Gitì— ì»¤ë°‹ ê¸ˆì§€!)
# .gitignoreì— ì¶”ê°€:
.env
*.db
output/
logs/
```

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [[í”„ë¡œì íŠ¸-ê°œìš”]] - í”„ë¡œì íŠ¸ ì „ì²´ ê°œìš”
- [[ì‚¬ìš©-ê°€ì´ë“œ]] - ì‚¬ìš©ë²•
- [[ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜]] - ì‹œìŠ¤í…œ êµ¬ì¡°
- [[Tech-Stack]] - ê¸°ìˆ  ìŠ¤íƒ

---

**ì—…ë°ì´íŠ¸:** 2026-02-05
**ìƒíƒœ:** ì„¤ì • ì™„ë£Œ
