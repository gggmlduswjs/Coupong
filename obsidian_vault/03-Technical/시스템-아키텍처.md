# ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

#technical #architecture #design

**ì‘ì„±ì¼:** 2026-02-05

---

## ğŸ—ï¸ ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ì¿ íŒ¡ ë„ì„œ ìë™í™” ì‹œìŠ¤í…œ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Data Source    â”‚
â”‚  (Aladin API)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ HTTP Request
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CRAWLER LAYER                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AladinAPICrawler                                            â”‚
â”‚  - search_books()                                            â”‚
â”‚  - ì—°ë„ ì¶”ì¶œ (Book.extract_year)                              â”‚
â”‚  - ì‹œë¦¬ì¦ˆ ì •ê·œí™” (Book.normalize_title)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Raw Book Data
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MODEL LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SQLAlchemy Models:                                          â”‚
â”‚  - Publisher (ë§ˆì§„ìœ¨, ê³µê¸‰ë¥ )                                 â”‚
â”‚  - Book (ISBN, ì œëª©, ê°€ê²©, ì—°ë„, ì‹œë¦¬ì¦ˆ)                      â”‚
â”‚  - Product (ë‹¨ê¶Œ ìƒí’ˆ, ë§ˆì§„ ì •ë³´)                             â”‚
â”‚  - BundleSKU (ë¬¶ìŒ ìƒí’ˆ)                                     â”‚
â”‚  - Listing (ì—…ë¡œë“œ í˜„í™©, ì¤‘ë³µ ì²´í¬)                           â”‚
â”‚  - Account (5ê°œ ê³„ì •)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Persisted Data
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DATABASE LAYER                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SQLite (coupang.db)                                         â”‚
â”‚  - 8ê°œ í…Œì´ë¸”                                                 â”‚
â”‚  - UNIQUE ì œì•½ì¡°ê±´ (ì¤‘ë³µ ë°©ì§€)                                â”‚
â”‚  - ì™¸ë˜í‚¤ ê´€ê³„                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Query Results
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ANALYZER LAYER                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MarginCalculator                                            â”‚
â”‚  - analyze_book()                                            â”‚
â”‚  - calculate_margin() â†’ ìˆœë§ˆì§„                               â”‚
â”‚  - determine_shipping_policy()                               â”‚
â”‚                                                              â”‚
â”‚  BundleGenerator                                             â”‚
â”‚  - find_bundleable_books()                                   â”‚
â”‚  - auto_generate_bundles()                                   â”‚
â”‚  - ì‹œë¦¬ì¦ˆë³„ ê·¸ë£¹í™”                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Analysis Results
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DISTRIBUTION LAYER                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SmartUploadSystem                                           â”‚
â”‚  - distribute_to_accounts()                                  â”‚
â”‚  - 5ê°œ ê³„ì • ë¶„ì‚°                                              â”‚
â”‚  - DB ë ˆë²¨ ì¤‘ë³µ ì²´í¬                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Account Assignments
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        EXPORT LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CSVGenerator                                                â”‚
â”‚  - generate_account_csv()                                    â”‚
â”‚  - ì¿ íŒ¡ ì—…ë¡œë“œ í¬ë§·                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ CSV Files
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Output Files   â”‚
â”‚  (CSV per       â”‚
â”‚   Account)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ ë°ì´í„° íë¦„

### 1. ìˆ˜ì§‘ ë‹¨ê³„ (Collection)

```
Aladin API
    â†“ (HTTP Request)
AladinAPICrawler.search_books(query="ìˆ˜ëŠ¥ì™„ì„±")
    â†“ (Parse JSON)
Raw Book Data
    {
        "isbn": "9788...",
        "title": "2025 ìˆ˜ëŠ¥ì™„ì„± êµ­ì–´",
        "priceStandard": 8000,
        "publisher": "í•œêµ­êµìœ¡ë°©ì†¡ê³µì‚¬"
    }
    â†“ (Extract Year, Normalize)
Enriched Book Data
    {
        "year": 2025,
        "normalized_title": "ìˆ˜ëŠ¥ì™„ì„± êµ­ì–´",
        "normalized_series": "ìˆ˜ëŠ¥ì™„ì„±"
    }
    â†“ (Save to DB)
books í…Œì´ë¸”
```

### 2. ë¶„ì„ ë‹¨ê³„ (Analysis)

```
books í…Œì´ë¸” (ISBN, ê°€ê²©, ì¶œíŒì‚¬)
    â†“ (Join publishers)
Publisher ì •ë³´ (ê³µê¸‰ë¥ , ë§ˆì§„ìœ¨)
    â†“ (Calculate)
MarginCalculator.analyze_book()
    {
        "list_price": 8000,
        "sale_price": 7200,
        "supply_cost": 2160,
        "margin": 4248,
        "net_margin": 2248,
        "shipping_policy": "free"
    }
    â†“ (Save to DB)
products í…Œì´ë¸”
```

### 3. ë¬¶ìŒ ìƒì„± ë‹¨ê³„ (Bundling)

```
products í…Œì´ë¸” (net_margin < 0)
    â†“ (Group by)
publisher_id + normalized_series + year
    â†“ (Generate Bundle)
BundleGenerator.auto_generate_bundles()
    {
        "bundle_key": "12_ê°œë…ì›ë¦¬ìˆ˜í•™_2025",
        "book_count": 3,
        "total_sale_price": 41400,
        "net_margin": 18746
    }
    â†“ (Save to DB)
bundle_skus í…Œì´ë¸”
```

### 4. ë¶„ì‚° ë‹¨ê³„ (Distribution)

```
products + bundle_skus í…Œì´ë¸”
    â†“ (Filter: status='ready')
ì—…ë¡œë“œ ê°€ëŠ¥ ìƒí’ˆ ëª©ë¡
    â†“ (Check duplicates)
SmartUploadSystem.distribute_to_accounts()
    For account_id in [1, 2, 3, 4, 5]:
        â†“ (Query existing)
        existing_isbns = SELECT isbn FROM listings WHERE account_id = ?
        â†“ (Exclude)
        available = products WHERE isbn NOT IN existing_isbns
        â†“ (Assign)
        INSERT INTO listings (account_id, isbn, ...)
```

### 5. ì¶œë ¥ ë‹¨ê³„ (Export)

```
listings í…Œì´ë¸” (account_idë³„)
    â†“ (Join products/bundles)
ì „ì²´ ìƒí’ˆ ì •ë³´
    â†“ (Format)
CSVGenerator.generate_account_csv()
    [
        ["ISBN", "ì œëª©", "íŒë§¤ê°€", "ë°°ì†¡ì •ì±…"],
        ["9788...", "ìˆ˜ëŠ¥ì™„ì„± êµ­ì–´", "7200", "ë¬´ë£Œë°°ì†¡"],
        ...
    ]
    â†“ (Write)
output/coupang_upload_account_1.csv
```

---

## ğŸ“¦ ì»´í¬ë„ŒíŠ¸ ì„¤ëª…

### 1. Crawler (ìˆ˜ì§‘)

**ì±…ì„:**
- ì•Œë¼ë”˜ API í˜¸ì¶œ
- JSON íŒŒì‹±
- ì—°ë„ ì¶”ì¶œ
- ì‹œë¦¬ì¦ˆ ì •ê·œí™”

**ì£¼ìš” í´ë˜ìŠ¤:**
- `AladinAPICrawler`

**ì…ë ¥:** ê²€ìƒ‰ ì¿¼ë¦¬ (ì˜ˆ: "ìˆ˜ëŠ¥ì™„ì„±")
**ì¶œë ¥:** ë„ì„œ ë°ì´í„° (Book ëª¨ë¸)

### 2. Model (ë°ì´í„° ëª¨ë¸)

**ì±…ì„:**
- ë°ì´í„° êµ¬ì¡° ì •ì˜
- DB ìŠ¤í‚¤ë§ˆ ë§¤í•‘
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (ë§ˆì§„ ê³„ì‚° ë“±)
- ì œì•½ì¡°ê±´ ì •ì˜

**ì£¼ìš” í´ë˜ìŠ¤:**
- `Publisher` - ì¶œíŒì‚¬ (calculate_margin)
- `Book` - ë„ì„œ (extract_year, normalize_title)
- `Product` - ë‹¨ê¶Œ ìƒí’ˆ
- `BundleSKU` - ë¬¶ìŒ ìƒí’ˆ (create_bundle)
- `Listing` - ì—…ë¡œë“œ í˜„í™©
- `Account` - ê³„ì • ê´€ë¦¬

**íŠ¹ì§•:**
- SQLAlchemy ORM ì‚¬ìš©
- ê´€ê³„ ì •ì˜ (ForeignKey, relationship)
- ì œì•½ì¡°ê±´ (UNIQUE, NOT NULL)

### 3. Analyzer (ë¶„ì„)

**ì±…ì„:**
- ë§ˆì§„ ê³„ì‚°
- ë°°ì†¡ ì •ì±… ê²°ì •
- ìˆ˜ìµì„± í‰ê°€
- ë¬¶ìŒ ëŒ€ìƒ ì„ ì •
- ë¬¶ìŒ ìƒì„±

**ì£¼ìš” í´ë˜ìŠ¤:**
- `MarginCalculator` - ë§ˆì§„ ë¶„ì„
- `BundleGenerator` - ë¬¶ìŒ ìƒì„±

**ì…ë ¥:** Book + Publisher
**ì¶œë ¥:** Product (ë§ˆì§„ ì •ë³´ í¬í•¨) ë˜ëŠ” BundleSKU

### 4. Distribution (ë¶„ì‚°)

**ì±…ì„:**
- ê³„ì •ë³„ ìƒí’ˆ í• ë‹¹
- ì¤‘ë³µ ì²´í¬
- ê· ë“± ë¶„ì‚°

**ì£¼ìš” í´ë˜ìŠ¤:**
- `SmartUploadSystem`

**ì•Œê³ ë¦¬ì¦˜:**
```python
for account in accounts:
    # 1. ì´ë¯¸ ì—…ë¡œë“œëœ ISBN ì¡°íšŒ
    existing = get_existing_isbns(account)

    # 2. ì‚¬ìš© ê°€ëŠ¥í•œ ìƒí’ˆ í•„í„°ë§
    available = [p for p in products if p.isbn not in existing]

    # 3. ì¼ì¼ í•œë„ë§Œí¼ í• ë‹¹
    assigned = available[:account.daily_upload_limit]

    # 4. listings í…Œì´ë¸”ì— ì €ì¥
    save_listings(account, assigned)
```

### 5. Export (ì¶œë ¥)

**ì±…ì„:**
- CSV í¬ë§· ìƒì„±
- ì¿ íŒ¡ ì—…ë¡œë“œ í˜•ì‹ ì¤€ìˆ˜
- íŒŒì¼ ì €ì¥

**ì£¼ìš” í´ë˜ìŠ¤:**
- `CSVGenerator`

**CSV í¬ë§·:**
```csv
ISBN,ì œëª©,íŒë§¤ê°€,ë°°ì†¡ë¹„,ë°°ì†¡ì •ì±…
9788...,ìˆ˜ëŠ¥ì™„ì„± êµ­ì–´ì˜ì—­,7200,0,ë¬´ë£Œë°°ì†¡
9789...,ê°œë…ì›ë¦¬ ìˆ˜í•™ 3ì¢… ì„¸íŠ¸,41400,0,ë¬´ë£Œë°°ì†¡
```

---

## ğŸ” ì¤‘ë³µ ë°©ì§€ ë©”ì»¤ë‹ˆì¦˜

### ë ˆë²¨ 1: ë°ì´í„°ë² ì´ìŠ¤ ì œì•½ì¡°ê±´

```sql
-- listings í…Œì´ë¸”
UNIQUE(account_id, isbn)         -- ë‹¨ê¶Œ ì¤‘ë³µ ë°©ì§€
UNIQUE(account_id, bundle_key)   -- ë¬¶ìŒ ì¤‘ë³µ ë°©ì§€
```

### ë ˆë²¨ 2: ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ì²´í¬

```python
def check_duplicate_before_assign(account_id, isbn):
    existing = db.query(Listing).filter(
        Listing.account_id == account_id,
        Listing.isbn == isbn
    ).first()

    if existing:
        raise DuplicateError(f"ì´ë¯¸ ì—…ë¡œë“œë¨: {isbn}")
```

### ë ˆë²¨ 3: ë¶„ì‚° ì‹œ í•„í„°ë§

```python
# ê³„ì •ë³„ ì´ë¯¸ ì—…ë¡œë“œëœ ISBN ì¡°íšŒ
existing_isbns = db.query(Listing.isbn).filter(
    Listing.account_id == account_id
).all()

# ì‚¬ìš© ê°€ëŠ¥í•œ ìƒí’ˆë§Œ ì„ íƒ
available_products = db.query(Product).filter(
    Product.isbn.notin_(existing_isbns),
    Product.status == 'ready'
).all()
```

---

## ğŸ“Š ì„±ëŠ¥ ìµœì í™”

### 1. ì¸ë±ìŠ¤ ì „ëµ

```sql
-- ìì£¼ ì¡°íšŒë˜ëŠ” ì»¬ëŸ¼ì— ì¸ë±ìŠ¤
CREATE INDEX idx_books_isbn ON books(isbn);
CREATE INDEX idx_books_publisher ON books(publisher_id);
CREATE INDEX idx_books_year ON books(year);
CREATE INDEX idx_books_normalized_series ON books(normalized_series);

CREATE INDEX idx_products_status ON products(status);
CREATE INDEX idx_products_shipping ON products(shipping_policy);

CREATE INDEX idx_listings_account ON listings(account_id);
CREATE INDEX idx_listings_isbn ON listings(isbn);
```

### 2. ì¿¼ë¦¬ ìµœì í™”

```python
# Bad: N+1 ë¬¸ì œ
for book in books:
    publisher = db.query(Publisher).filter(
        Publisher.id == book.publisher_id
    ).first()  # ë§¤ë²ˆ ì¿¼ë¦¬!

# Good: JOIN ì‚¬ìš©
books = db.query(Book).join(Publisher).all()
for book in books:
    publisher = book.publisher  # ì´ë¯¸ ë¡œë“œë¨
```

### 3. ë°°ì¹˜ ì²˜ë¦¬

```python
# Bad: ê±´ë³„ INSERT
for product in products:
    db.add(product)
    db.commit()  # ë§¤ë²ˆ ì»¤ë°‹!

# Good: ë°°ì¹˜ ì»¤ë°‹
for product in products:
    db.add(product)
db.commit()  # í•œ ë²ˆë§Œ ì»¤ë°‹
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ëµ

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (Unit Tests)

```python
# ëª¨ë¸ í…ŒìŠ¤íŠ¸
def test_book_extract_year():
    assert Book.extract_year("2025 ìˆ˜ëŠ¥ì™„ì„±") == 2025
    assert Book.extract_year("EBS 24ë…„") == 2024

# ê³„ì‚° í…ŒìŠ¤íŠ¸
def test_publisher_calculate_margin():
    publisher = Publisher(supply_rate=0.27)
    result = publisher.calculate_margin(list_price=8000)
    assert result['net_margin'] == 2248
```

### í†µí•© í…ŒìŠ¤íŠ¸ (Integration Tests)

```python
# ì „ì²´ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸
def test_full_workflow():
    # 1. í¬ë¡¤ë§
    crawler = AladinAPICrawler()
    books = crawler.search_books("í…ŒìŠ¤íŠ¸", max_results=10)

    # 2. ë¶„ì„
    calculator = MarginCalculator()
    products = calculator.analyze_books(books)

    # 3. ë¬¶ìŒ ìƒì„±
    generator = BundleGenerator()
    bundles = generator.auto_generate_bundles()

    # 4. ë¶„ì‚°
    system = SmartUploadSystem()
    system.distribute_to_accounts(products)

    # 5. CSV ìƒì„±
    exporter = CSVGenerator()
    csv_files = exporter.generate_all()

    assert len(csv_files) == 5  # 5ê°œ ê³„ì •
```

### ì œì•½ì¡°ê±´ í…ŒìŠ¤íŠ¸

```python
def test_duplicate_prevention():
    # ê°™ì€ ê³„ì •ì— ê°™ì€ ISBN ë‘ ë²ˆ ì—…ë¡œë“œ ì‹œë„
    listing1 = Listing(account_id=1, isbn="9788...")
    db.add(listing1)
    db.commit()

    listing2 = Listing(account_id=1, isbn="9788...")
    db.add(listing2)

    with pytest.raises(IntegrityError):
        db.commit()  # UNIQUE ì œì•½ ìœ„ë°˜
```

---

## ğŸ”„ í™•ì¥ ê°€ëŠ¥ì„±

### 1. ë‹¤ë¥¸ API ì¶”ê°€

```python
# crawlers/yes24_crawler.py
class Yes24Crawler(BaseCrawler):
    def search_books(self, query):
        # Yes24 API í˜¸ì¶œ
        pass
```

### 2. ë‹¤ë¥¸ ë§ˆì¼“í”Œë ˆì´ìŠ¤ ì¶”ê°€

```python
# exporters/gmarket_exporter.py
class GMarketExporter(BaseExporter):
    def generate_csv(self, products):
        # Gë§ˆì¼“ í¬ë§·ìœ¼ë¡œ CSV ìƒì„±
        pass
```

### 3. ë¶„ì„ ì—”ì§„ ì¶”ê°€

```python
# analyzers/sales_analyzer.py
class SalesAnalyzer:
    def analyze_performance(self, listings):
        # íŒë§¤ ë°ì´í„° ë¶„ì„
        # ë…¸ì¶œ/í´ë¦­/ì „í™˜ìœ¨ ê³„ì‚°
        pass
```

### 4. ëŒ€ì‹œë³´ë“œ ì¶”ê°€

```python
# dashboard/streamlit_app.py
import streamlit as st

st.title("ì¿ íŒ¡ ë„ì„œ íŒë§¤ ëŒ€ì‹œë³´ë“œ")
st.metric("ì´ ì—…ë¡œë“œ", len(listings))
st.metric("ì›” ë§¤ì¶œ", total_revenue)
st.chart(sales_by_date)
```

---

## ğŸ›¡ï¸ ì—ëŸ¬ ì²˜ë¦¬

### 1. API ì—ëŸ¬

```python
try:
    response = requests.get(url, timeout=10)
    response.raise_for_status()
except requests.Timeout:
    logger.error("API íƒ€ì„ì•„ì›ƒ")
except requests.HTTPError as e:
    logger.error(f"HTTP ì—ëŸ¬: {e}")
```

### 2. DB ì—ëŸ¬

```python
try:
    db.add(listing)
    db.commit()
except IntegrityError:
    db.rollback()
    logger.warning(f"ì¤‘ë³µ ì—…ë¡œë“œ ì‹œë„: {listing.isbn}")
except SQLAlchemyError as e:
    db.rollback()
    logger.error(f"DB ì—ëŸ¬: {e}")
```

### 3. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì—ëŸ¬

```python
class InsufficientMarginError(Exception):
    """ìˆœë§ˆì§„ì´ ìµœì†Œ ê¸°ì¤€ ë¯¸ë‹¬"""
    pass

def validate_margin(product, min_margin=0):
    if product.net_margin < min_margin:
        raise InsufficientMarginError(
            f"ìˆœë§ˆì§„ ë¶€ì¡±: {product.net_margin}ì› < {min_margin}ì›"
        )
```

---

## ğŸ“ ë¡œê¹… ì „ëµ

### 1. êµ¬ì¡°í™”ëœ ë¡œê¹…

```python
import logging

logger = logging.getLogger(__name__)

# ë¡œê·¸ ë ˆë²¨ë³„ ì‚¬ìš©
logger.debug("ìƒì„¸ ë””ë²„ê·¸ ì •ë³´")
logger.info("ì¼ë°˜ ì •ë³´")
logger.warning("ê²½ê³  (ì²˜ë¦¬ ê°€ëŠ¥)")
logger.error("ì—ëŸ¬ (ì²˜ë¦¬ í•„ìš”)")
logger.critical("ì¹˜ëª…ì  ì—ëŸ¬")
```

### 2. Obsidian í†µí•© ë¡œê¹…

```python
from obsidian_logger import ObsidianLogger

obsidian = ObsidianLogger()

# ê¸°ëŠ¥ ë¡œê¹…
obsidian.log_feature("ë§ˆì§„ ê³„ì‚°", "ì¶œíŒì‚¬ë³„ ë§ˆì§„ ìë™ ê³„ì‚°")

# ê¸°ìˆ  ë¡œê¹…
obsidian.log_technical("API í˜¸ì¶œ", "ì•Œë¼ë”˜ API í†µí•© ì™„ë£Œ")

# ë²„ê·¸ ë¡œê¹…
obsidian.log_bug("ì¤‘ë³µ ì²´í¬", "UNIQUE ì œì•½ ìœ„ë°˜", "ì œì•½ì¡°ê±´ ì¶”ê°€")
```

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [[í”„ë¡œì íŠ¸-ê°œìš”]] - í”„ë¡œì íŠ¸ ì „ì²´ ê°œìš”
- [[Database-Schema-V2]] - ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
- [[Tech-Stack]] - ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸
- [[ë§ˆì§„-ê³„ì‚°ê¸°]] - ë§ˆì§„ ê³„ì‚° ë¡œì§
- [[ë¬¶ìŒ-SKU-ìƒì„±ê¸°]] - ë¬¶ìŒ ìƒì„± ë¡œì§

---

**ì‘ì„±:** 2026-02-05
**ìƒíƒœ:** ë¬¸ì„œí™” ì™„ë£Œ
