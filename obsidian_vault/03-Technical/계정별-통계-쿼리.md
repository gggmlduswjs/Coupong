# 계정별 통계 쿼리

#technical #query #statistics

**작성일:** 2026-02-05 00:36

---


        ## SQL 쿼리

        ```python
        stats = db.query(
            Listing.account_id,
            func.count(Sales.id).label('count'),
            func.sum(Sales.revenue).label('total_revenue'),
            func.avg(Sales.profit).label('avg_profit')
        ).join(Sales).group_by(Listing.account_id).all()
        ```

        ## 성능

        - 인덱스: account_id, sale_date
        - 평균 실행 시간: 10ms
        - 최적화: 필요 시 인덱스 추가

        ## 테스트

        ```python
        def test_account_statistics():
            stats = get_account_statistics()
            assert len(stats) == 5  # 5개 계정
            assert all(s['count'] >= 0 for s in stats)
        ```
        

---

## 관련 노트

- [[Index]]
- [[Tech Stack]]
